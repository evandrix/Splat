<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
          "http://www.w3.org/TR/html40/loose.dtd">

<html>
         
  <head>
    <title>Module: FileParsing</title>
  </head>

  <body bgcolor="#ffffff">

        <p><i><a href="../../../index.html">Table of Contents</a></i></p>
        
        <table border="0" cellpadding="5" cellspacing="0" width="100%">
        <tr>
            <th rowspan="2"
                valign="top"
                align="left"
                width="10%"
                bgcolor="#88bbee"><font color="#000000">Module: FileParsing</font>
            </th>
            <th bgcolor="#88bbee"
                width="90%"
                align="right"><font color="#000000">./src/peak/util/FileParsing.py</font>
            </th>
        </tr>
        <tr>
        <td>
        
<h3>Line-Oriented File Parsing Tools</h3>
<p>    This module supplies functions for creating and using &quot;lineInfo&quot;
    streams, which are iterables of <code>(source,lineNo,line)</code> tuples. The
    <code>source</code> is an indicator of the line's origin (e.g. a filename),
    while <code>lineNo</code> is its line number within that source.  <code>line</code> is
    the actual text of the line.  This data structure is simple, fast,
    and easy to use.</p>
<p>    This module was created because the standard library <code>ConfigParser</code>
    makes a lot of assumptions about syntax that don't necessarily
    work with every config file. For example, it assumes directives
    are order-insensitive key-value pairs, which doesn't work well for
    systems like PEAK, which might prefer to process a stream of
    directives in the original sequence.</p>
<p>    So, this module uses a stream-processing approach that should provide
    a reusable foundation for other types of line-oriented text processing.
    The basic tools are the <code>fromStream()</code>, <code>fromFile()</code>, and <code>fromString()</code>
    functions, which respectively take an iterable, a filename, or a string,
    and return an iterator that yields <code>(source,lineNo,line)</code> tuples.</p>
<p>    Once you have a stream to play with, you can then use some of the
    processors such as <code>iterConfigSections()</code> and <code>iterConfigSettings()</code>,
    which return iterators yielding various kinds of configuration data
    (based on ConfigParser-like syntax rules).  Or, you can use the
    <code>AbstractConfigParser</code> class as a base class to create your own
    specialized parsers.</p>
<table border="0" cellpadding="5" cellspacing="0" width="100%">

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Imported modules">Imported modules</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
<b>from</b> <a href="http://www.python.org/doc/current/lib/module-__future__.html">__future__</a> <b>import</b> generators<br>
<b>import</b> <a href="http://www.python.org/doc/current/lib/module-re.html">re</a><br>

</td></tr>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Functions">Functions</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
<a href="#fromFile">fromFile</a><br>
<a href="#fromStream">fromStream</a><br>
<a href="#fromString">fromString</a><br>
<a href="#iterConfigSections">iterConfigSections</a><br>
<a href="#iterConfigSettings">iterConfigSettings</a><br>


        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="fromFile"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">fromFile&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
fromFile ( filename,  mode='r' )

</pre></font>

<h3>Produce <code>(source,lineNo,line)</code> tuple stream from input file</h3>
<p>    This is the equivalent of <code>fromStream(open(filename,mode), filename)</code>.
    That is, it returns a line-info iterator with a source of <code>filename</code>
    and the lines from <code>open(filename,mode).readlines()</code>.</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="fromStream"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">fromStream&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
fromStream ( stream,  source=None )

</pre></font>

<h3>Produce <code>(source,lineNo,line)</code> tuple stream from input lines</h3>
<p>    Calling <code>fromStream(stream,source)</code> returns an iterator which yields
    <code>(source,lineNo,line)</code> tuples for each line in <code>stream</code>.</p>
<p>    <code>stream</code> must be a sequence, iterator, or iterable file-like object
    that yields text lines.  (Line ending characters are stripped
    from line ends.)</p>
<p>    <code>source</code> should be a short string (e.g. filename) or other useful
    identifier of where the lines came from.</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="fromString"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">fromString&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
fromString ( text,  source='&lt;string&gt;' )

</pre></font>

<h3>Produce <code>(source,lineNo,line)</code> tuple stream from input file</h3>
<p>    This is the equivalent of <code>fromStream(StringIO(text), source)</code>.
    That is, it returns a line-info iterator with the supplied
    source name (default is <code>"&lt;string&gt;"</code>) and the lines from
    <code>StringIO(text).readlines()</code>.</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="iterConfigSections"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">iterConfigSections&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
iterConfigSections ( lineSource )

</pre></font>

<h3><code>(section,lines,info)</code> tuples per .ini-like section in <code>lineSource</code></h3>
<p>    This function is used to break up a configuration file (.ini or
    ConfigParser-style) into sections based on '[]<code>-enclosed section
    names.  It returns an iterator which yields </code>(section,lines,info)'
    tuples for each section in the file.  The first yielded <code>section</code>
    will be <code>None</code> if any lines appear before the first section heading;
    all others will be the string that was between the <code>[]</code>.</p>
<p>    <code>lines</code> is always a list of <code>(source,lineNo,line)</code> tuples, suitable
    for use by <code>iterConfigSettings()</code> or other lineInfo stream processors.</p>
<p>    <code>info</code> is a <code>(source,lineNo,line)</code> tuple representing the line where
    the section header (if any) appeared.</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="iterConfigSettings"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">iterConfigSettings&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
iterConfigSettings ( lineSource )

</pre></font>

<h3><code>(name,value,lineInfo)</code> tuples per .ini-like setting in <code>lineSource</code></h3>
<p>    <code>name</code> and <code>value</code> will be <code>None</code> for any non-blank, non-comment line
    which does not appear to be a valid option.  Otherwise, they are the
    setting's name and value, respectively.</p>
<p>    <code>lineInfo</code> is a standard lineInfo-tuple of <code>(source,lineNo,line)</code> data,
    with the difference that continuation lines are concatenated to <code>line</code>.
    This is so that if one needs to display an error message that shows the
    source of the parsed value, the full logical line is included, even though
    the first physical line number would be used to identify the error line.</p>
<h4>    Continuation Lines</h4>
<p>        RFC822-style line continuations are supported, with leading whitespace
        stripped from continuation lines, and <code>"\n"</code> separating the lines in
        the returned value.  Unlike ConfigParser, no other interpretation of
        <code>name</code> or <code>value</code> is done, so it's up to you to do any case-folding,
        conversions, etc.</p>
<h4>    Comment and Whitespace (blank line) Processing</h4>
<p>        Comment lines are lines which begin with a ';', <code>#</code>, or the word
        <code>rem</code> (case-insensitive).  No leading whitespace is allowed, to
        prevent confusion with continuation lines.  Because setting values
        are not interpreted, comments embedded on the same line with a setting
        or indented in a continuation line are returned as part of the value
        text.  If you want to support embedded comments, it is up to you to
        parse them out of the value.</p>
<p>        Comment lines are completely ignored, so you <em>can</em> have a comment
        line inside a series of continuation lines, as long as it has no
        leading whitespace on the line.  Blank (empty or whitespace-only)
        lines within a series of continuation lines are considered part of
        the setting value, and are rendered as empty lines in the value.
        Blank lines which appear at the end of a setting value, or before
        the first setting in the input stream, are ignored.</p>
</td></tr>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Classes">Classes</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
<table border="0" cellpadding="3" cellspacing="0">
<tr><td valign="top" align="left"><p><a href="FileParsing/AbstractConfigParser.html">AbstractConfigParser</a></p></td><td valign="top" align="left">
<p>Abstract configuration file parser based on sections and settings</p>
</td></tr>
</table>
</td></tr>
</td></tr>
</table>

        </td>
        </tr>
        </table>

        <hr>

        <p><i><a href="../../../index.html">Table of Contents</a></i></p>

        <font size="-2"><i>This document was automatically generated
        on Tue Feb 17 19:55:52 2004 by
        <a href="http://happydoc.sourceforge.net">HappyDoc</a> version
        2.1</i></font>
        
        </body>
        </html>
        