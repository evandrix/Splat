<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
          "http://www.w3.org/TR/html40/loose.dtd">

<html>
         
  <head>
    <title>Module: clusters</title>
  </head>

  <body bgcolor="#ffffff">

        <p><i><a href="../../../index.html">Table of Contents</a></i></p>
        
        <table border="0" cellpadding="5" cellspacing="0" width="100%">
        <tr>
            <th rowspan="2"
                valign="top"
                align="left"
                width="10%"
                bgcolor="#88bbee"><font color="#000000">Module: clusters</font>
            </th>
            <th bgcolor="#88bbee"
                width="90%"
                align="right"><font color="#000000">./src/peak/running/clusters.py</font>
            </th>
        </tr>
        <tr>
        <td>
        
<h3>Utilities for dealing with clusters of loosely-coupled systems.</h3>
<p> Many enterprise applications will be run, rather than on a single
 computer, in a loosely-coupled cluster of machines.  A set of several
 web-servers, for example.  We have found the
 <a href="http://www.garbled.net/clusterit.html">clusterit tools</a> to be very useful
 in such situations.  Clusterit, inspired by the tools provided in IBM's
 PSSP, is simple to set up and use, if somewhat quirky in implementation.</p>
<p> PEAK supports the cluster definition file used by Clusterit-2.0, providing
 the information contained therein via the properties mechanism.  Note
 that you don't have to have the Clusterit tools installed to make use of
 this, or for it to be useful.  Nor will anything break if you make use
 of these properties in your application and they haven't been set up.
 In the abscence of a cluster definition file, PEAK will behave as if
 the local hostname was listed in the cluster file, without being part
 of a group.  In other words, in the abscence of other information, the
 cluster consists of just the local machine.</p>
<p> Then environment variable <code>CLUSTER</code> (or, in PEAK's case, the property
 <code>peak.running.cluster._filename</code>, if it exists, else
 <code>__main__.CLUSTER</code>, which falls back to <code>environ.CLUSTER</code>)
 specifies a file defining the cluster.  A cluster may be subdivided into
 groups.  In PEAK it is allowable for groups to have overlapping
 membership.  Let's look at a fairly complicated example:
<pre>
    foo.baz.com
    bar.baz.com
    GROUP:odd
    one.baz.com
    three.baz.com
    five.baz.com
    GROUP:even
    two.baz.com
    four.baz.com
    six.baz.com
    GROUP:prime
    one.baz.com
    two.baz.com
    three.baz.com
    five.baz.com
    GROUP:qux
    frob.baz.com
    one.baz.com
    LUMP:weird
    qux
    prime
</pre>
</p>
<p> PEAK treats this file as if it had seven groups.  The existance and
 memberships of the first four groups, <code>odd</code>, <code>even</code>, <code>prime</code>, and <code>qux</code>,
 should be clear.  A &quot;lump&quot; is a group defined in terms of other groups or
 lumps.  In this case the group <code>weird</code> contains the union of the groups
 <code>qux</code> and <code>prime</code>.  Note that one.baz.com is a member of both qux and prime.
 The group <code>weird</code> will contain it only once, however -- duplicates are
 removed automatically.  Another group, <code>__orphans__</code>, contains any hosts
 that were listed at the beginning of the file before any <code>GROUP:</code> lines.
 Lastly the group <code>__all__</code> contains all hosts listed in the file.</p>
<p> Each group is exported as a property <code>peak.running.cluster.groups.&lt;groupname&gt;</code>
 (for example, <code>peak.running.cluster.groups.prime</code>) with its value a tuple of
 strings of the hostnames of the members.</p>
<p> The property <code>peak.running.cluster.groups</code> will contain a tuple of strings
 naming each group except the <code>__orphans__</code> and <code>__all__</code> groups (that
 is, it names all the explicitly-created groups).</p>
<p> The property <code>peak.running.cluster.hosts.&lt;hostname&gt;</code> will be a tuple of
 strings of the names of all groups the host belongs to (except the
 __all__ group).  For example, in the example above,
 'peak.running.cluster.hosts.one.baz.com'is <code>("odd", "prime", "qux", "wierd")</code>.</p>
<p> The property <code>peak.running.cluster.hosts</code> is a shortcut for
 <code>peak.running.cluster.groups.__all__</code>, listing all hosts in the cluster.</p>
<p> Finally, the property <code>peak.running.cluster.hostname</code> is a string with
 the local machine's network hostname (per <code>socket.gethostname()</code>), and
 <code>peak.running.cluster.shortname</code> is the the same, truncated after the
 first <code>"."</code>, if any.</p>
<table border="0" cellpadding="5" cellspacing="0" width="100%">

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Imported modules">Imported modules</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
<b>from</b> kjbuckets <b>import</b> *<br>
<b>import</b> <a href="http://www.python.org/doc/current/lib/module-os.html">os</a><br>
<b>from</b> peak.api <b>import</b> *<br>

</td></tr>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Functions">Functions</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
<a href="#loadCluster">loadCluster</a><br>
<a href="#parseCluster">parseCluster</a><br>


        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="loadCluster"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">loadCluster&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
loadCluster (
        configMap,
        filename=None,
        prefix='peak.running.cluster.*',
        propertyName=None,
        includedFrom=None,
        )

</pre></font>


        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="parseCluster"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">parseCluster&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
parseCluster ( prefix,  fn )

</pre></font>

</td></tr>
</td></tr>
</table>

        </td>
        </tr>
        </table>

        <hr>

        <p><i><a href="../../../index.html">Table of Contents</a></i></p>

        <font size="-2"><i>This document was automatically generated
        on Tue Feb 17 19:55:49 2004 by
        <a href="http://happydoc.sourceforge.net">HappyDoc</a> version
        2.1</i></font>
        
        </body>
        </html>
        