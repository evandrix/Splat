<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
          "http://www.w3.org/TR/html40/loose.dtd">

<html>
         
  <head>
    <title>Module: lockfiles</title>
  </head>

  <body bgcolor="#ffffff">

        <p><i><a href="../../../index.html">Table of Contents</a></i></p>
        
        <table border="0" cellpadding="5" cellspacing="0" width="100%">
        <tr>
            <th rowspan="2"
                valign="top"
                align="left"
                width="10%"
                bgcolor="#88bbee"><font color="#000000">Module: lockfiles</font>
            </th>
            <th bgcolor="#88bbee"
                width="90%"
                align="right"><font color="#000000">./src/peak/running/lockfiles.py</font>
            </th>
        </tr>
        <tr>
        <td>
        
<h3>Lockfiles for inter-process communication</h3>
<p>    These are used for synchronization between processes, unlike
    thread.LockType locks.  The common use is non-blocking lock attempts.
    For convenience and in order to reduce confusion with the (somewhat odd)
    thread lock interface, these locks have a different interface.</p>
<p>    attempt()   try to obtain the lock, return boolean success
    obtain()    wait to obtain the lock, returns None
    release()   release an obtained lock, returns None
    locked()    returns True if any thread IN THIS PROCESS
                has obtained the lock, else False</p>
<p>    In general, you should assume that only the <code>LockFile</code> class will be
    available.  Only use a more-specific lockfile type if you have need
    of compatibility with non-PEAK software that uses that special type
    of lockfile.  (In practice, this means that the only time you'll ever
    use anything other than the generic <code>LockFile</code> class is if you need
    to work with something on a Unix-like platform that uses the equivalent
    of <code>FLockFile</code>, as <code>SHLockFile</code> is the default implementation of <code>LockFile</code>
    on Unix-like platforms.)</p>
<p>    Currently, only Unix-ish and Windows platforms supported; if your platform
    isn't supported, not even the <code>LockFile</code> class will be available from this
    module.  For Windows, the <code>msvcrt</code> module must be available (it is in the
    standard Python 2.2.1 binary distribution for Windows).</p>
<p>    This module also exports a <code>NullLockFile</code> class, for use when locking is
    not needed, but an object with a locking interface is nonetheless required.
    <code>NullLockFile</code> can also be used as a substitute for a thread lock, if you
    prefer this locking interface over the standard Python one.</p>
<table border="0" cellpadding="5" cellspacing="0" width="100%">

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Imported modules">Imported modules</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
<b>import</b> errno<br>
<b>from</b> <a href="interfaces.html">interfaces</a> <b>import</b> <a href="interfaces/ILock.html">ILock</a><br>
<b>import</b> <a href="http://www.python.org/doc/current/lib/module-os.html">os</a><br>
<b>from</b> peak.api <b>import</b> naming, protocols<br>
<b>from</b> peak.naming.factories.openable <b>import</b> FileURL<br>
<b>from</b> peak.util.threads <b>import</b> allocate_lock<br>
<b>import</b> <a href="http://www.python.org/doc/current/lib/module-time.html">time</a><br>

</td></tr>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Functions">Functions</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
<a href="#check_lock">check_lock</a><br>
<a href="#make_tempfile">make_tempfile</a><br>
<a href="#pid_exists">pid_exists</a><br>


        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="check_lock"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">check_lock&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
check_lock ( fn )

</pre></font>

<h3>Check the validity of an existing lock file</h3>
<p>    Reads the PID out of the lock and check if that process exists</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="make_tempfile"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">make_tempfile&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
make_tempfile ( fn,  pid )

</pre></font>


        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="pid_exists"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">pid_exists&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
pid_exists ( pid )

</pre></font>

<p>Is there a process with PID pid?</p>
</td></tr>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Classes">Classes</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
<table border="0" cellpadding="3" cellspacing="0">
<tr><td valign="top" align="left"><p><a href="lockfiles/FLockFile.html">FLockFile</a></p></td><td valign="top" align="left">
<p>flock(3)-based locks.</p>
</td></tr>
<tr><td valign="top" align="left"><p><a href="lockfiles/LockFileBase.html">LockFileBase</a></p></td><td valign="top" align="left">
<p>Common base for lockfiles</p>
</td></tr>
<tr><td valign="top" align="left"><p><a href="lockfiles/NullLockFile.html">NullLockFile</a></p></td><td valign="top" align="left">
<p>Pseudo-LockFile (locks only for threads in this process)</p>
</td></tr>
<tr><td valign="top" align="left"><p><a href="lockfiles/SHLockFile.html">SHLockFile</a></p></td><td valign="top" align="left">
<p>HoneyDanBer/NNTP/shlock(1)-style locking</p>
</td></tr>
<tr><td valign="top" align="left"><p><a href="lockfiles/WinFLockFile.html">WinFLockFile</a></p></td><td valign="top" align="left">
<p>Like FLockFile, but for Windows</p>
</td></tr>
<tr><td valign="top" align="left"><p><a href="lockfiles/lockfileURL.html">lockfileURL</a></p></td><td valign="top" align="left"></td></tr>
</table>
</td></tr>
</td></tr>
</table>

        </td>
        </tr>
        </table>

        <hr>

        <p><i><a href="../../../index.html">Table of Contents</a></i></p>

        <font size="-2"><i>This document was automatically generated
        on Tue Feb 17 19:55:49 2004 by
        <a href="http://happydoc.sourceforge.net">HappyDoc</a> version
        2.1</i></font>
        
        </body>
        </html>
        