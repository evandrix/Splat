<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
          "http://www.w3.org/TR/html40/loose.dtd">

<html>
         
  <head>
    <title>Module: Meta</title>
  </head>

  <body bgcolor="#ffffff">

        <p><i><a href="../../../index.html">Table of Contents</a></i></p>
        
        <table border="0" cellpadding="5" cellspacing="0" width="100%">
        <tr>
            <th rowspan="2"
                valign="top"
                align="left"
                width="10%"
                bgcolor="#88bbee"><font color="#000000">Module: Meta</font>
            </th>
            <th bgcolor="#88bbee"
                width="90%"
                align="right"><font color="#000000">./src/peak/util/Meta.py</font>
            </th>
        </tr>
        <tr>
        <td>
        
<h3>Support for inheritance of metaclass constraints</h3>
<p>    This module exports a <code>makeClass</code> function that can be used as a
    <code>__metaclass__</code> value in class definitions to provide enhanced metaclass
    capabilities, such as specifying multiple metaclasses, and automatic
    generation of a satisfactory metaclass based on the information provided.</p>
<p>    PEAK automatically uses this function to build your classes when
    you use <code>config.setupModule()</code>, so you don't usually need to use this
    directly.  But if you want to know more about what it does and how it
    works, or have a special need, this is the right place to look.</p>
<table border="0" cellpadding="5" cellspacing="0" width="100%">

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Imported modules">Imported modules</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
<b>from</b> protocols.advice <b>import</b> minimalBases<br>
<b>from</b> <a href="http://www.python.org/doc/current/lib/module-types.html">types</a> <b>import</b> ClassType<br>
<b>from</b> <a href="http://www.python.org/doc/current/lib/module-weakref.html">weakref</a> <b>import</b> WeakValueDictionary<br>

</td></tr>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Functions">Functions</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
<a href="#derivedMeta">derivedMeta</a><br>
<a href="#makeClass">makeClass</a><br>
<a href="#metaFromBases">metaFromBases</a><br>
<a href="#normalizeBases">normalizeBases</a><br>


        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="derivedMeta"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">derivedMeta&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
derivedMeta ( metaclasses )

</pre></font>


        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="makeClass"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">makeClass&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
makeClass (
        name,
        bases,
        dict,
        )

</pre></font>

<h3>makeClass(name, bases, dict) - enhanced class creation</h3>
<p>    Automatically generates a metaclass that satisfies metaclass constraints
    inherited from the supplied base classes, and then calls it to create a
    new class.  It can be used as a <code>__metaclass__</code> value, or can be directly
    called as a substitute to using <code>new.classobject()</code> to dynamically create
    classes.</p>
<p>    If the supplied dictionary contains a <code>__metaclasses__</code> entry, it will be
    taken to be a sequence of metaclasses which should take first priority in
    the base classes of the generated metaclass.  The next highest priority is
    given to the dictionary's <code>__metaclass__</code> entry, if any, and then priority
    is according to the order of the base classes which introduce the metaclass
    constraints.</p>
<p>    <code>ClassType</code> (the &quot;classic&quot; class type) is automatically excluded from the
    constraints, as is the <code>makeClass</code> function itself (just in case you used
    the function as an explicit metaclass).  <code>makeClass()</code> will only return
    a &quot;classic&quot; class if all the base classes are classic, and no
    <code>__metaclass__</code> or <code>__metaclasses__</code> entries supply any non-classic
    types.  Effectively, <code>makeClass()</code> fully supports the three most popular
    Python metatypes: &quot;classic classes&quot;, &quot;new-style types&quot;, and
    <code>ExtensionClass</code>.  You cannot, however, combine ExtensionClasses with
    new-style types, because their root metatypes are different.  That is,
    <code>type(type) is type</code>, and <code>type(ExtensionClass) is ExtensionClass</code>.  There
    may be other ways to create illegal metatype combinations, but they should
    be detected and result in a TypeError.</p>
<p>    Generated metaclasses are cached for reuse, and they are automatically
    given classnames which are the concatenation of their base metaclasses'
    names.  So if you set <code>__metaclasses__</code> to <code>ThreadSafe, Persistent</code>
    (or if your bases are instances of <code>ThreadSafe</code> and <code>Persistent</code>), the
    derived metaclass will be called <code>ThreadSafe_Persistent</code>.  That is,
    the return from <code>makeClass()</code> will be of type (have a <code>__class__</code> of)
    <code>ThreadSafe_Persistent</code>.</p>
<p>    Metaclasses are derived according to the algorithm in the book &quot;Putting
    Metaclasses to Work&quot;, by Ira R. Forman and Scott H. Danforth.  It, and
    Guido's metaclass tutorial for Python 2.2, are highly recommended reading
    for making the best use of this capability.  But a brief word to the wise:
<ul>
<li><p>Write your metaclasses co-operatively!  Don't assume that your
          metaclass will be the first or last one to handle a particular
          method call.</p></li>
<li><p>In general, when programming with new-style classes, don't assume
          you know what the inheritance order is.  Always use 'super()';
          <code>super()</code> is your friend.  :)  Remember that your immediate base
          class today, may have other classes sandwiched between you and it
          tomorrow, if one of your subclasses so desires!</p></li>

</ul>
</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="metaFromBases"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">metaFromBases&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
metaFromBases ( bases )

</pre></font>

<table border="0" cellpadding="5" cellspacing="0" width="100%">

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Exceptions">Exceptions</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
TypeError( "Incompatible root metatypes", bases )<br>

</td></tr>
</table>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="normalizeBases"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">normalizeBases&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
normalizeBases ( allBases )

</pre></font>

</td></tr>
</td></tr>
</table>

        </td>
        </tr>
        </table>

        <hr>

        <p><i><a href="../../../index.html">Table of Contents</a></i></p>

        <font size="-2"><i>This document was automatically generated
        on Tue Feb 17 19:55:52 2004 by
        <a href="http://happydoc.sourceforge.net">HappyDoc</a> version
        2.1</i></font>
        
        </body>
        </html>
        